<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        *{
            margin: 0;
            padding: 0px;
        }
        .box{
            width: 300px;
            height: 500px;
            border: 1px solid red;
            margin: 50px auto;
            padding: 10px;
            overflow: hidden;
            position: relative;
        }
        .scroll{
            width: 20px;
            height: 530px;
            background-color: #ccc;
            position: absolute;
            top: 0;
            right: 0;
        }
        .bar{
            width: 20px;
            /*由内容决定高度*/
            height: 200px;
            border-radius: 10px;
            background-color: red;
            cursor: pointer;
            /*必须把bar设置成 position: absolute;才能移动bar*/
            position: absolute;
        }



    </style>
    <script src="06-放大镜/animate.js"></script>
    <script>

        window.onload = function () {
            // <!--需求:模拟滚动条,鼠标拖动滚动条,滚动条动,而且内容等比例联动-->
            // 步骤:
            // 1.根据内容和盒子的比例,确定bar的高度
            // 2.绑定事件(鼠标按下,然后移动)
            // 3.鼠标移动,bar联动
            // 4.内容等比例联动

            var box = document.getElementsByTagName('div')[0];
            var content = box.children[0];
            var scroll = box.children[1];
            var bar = scroll.children[0];

            // 求bar的高:内容的高/盒子的高 = scroll的高/bar的高
            // bar的高 = 盒子的高*scroll的高/内容的高
            var barHeight =  box.offsetHeight*scroll.offsetHeight/content.offsetHeight;
            bar.style.height = barHeight+ 'px';

            bar.onmousedown = function (event) {
                // 模拟拖拽案例
                // 1.获取鼠标在页面的位置
                event = event || window.event;
                var pageyy = event.pageY || scroll.top + event.clientY;
                // 鼠标在盒子中的距离:
                var y =pageyy - bar.offsetTop;
                // 鼠标移动bar移动
                document.onmousemove = function (event) {
                    event = event || window.event;
                    // 新五步:
                    var pagey = event.pageY || scroll.top + event.clientY;
                    // 老师版:
                    // 移动距离=鼠标的位置-鼠标在盒子中的位置
                    movey = pagey - y;
                    // 自己写得:如果小于barHeight/2将无法移动,有bug
                    // var movey = pageY-barHeight/2;
                    if(movey<0){movey = 0}
                    else if(movey>(box.offsetHeight-barHeight)){
                        movey = (box.offsetHeight-barHeight);
                    }
                    bar.style.top = movey + "px";
                    // 比例:内容走的距离/bar走的距离 = (内容的高-大盒子的高)/(scroll的高-bar的高)
                    var conetentY = movey*(content.offsetHeight-(box.offsetHeight-28))/(scroll.offsetHeight-barHeight);
                    content.style.marginTop = -conetentY+"px";
                    //在移动时禁止文本选中（选中后取消）(兼容性写法)
                    // IE9、Firefox、Safari、Chrome和Opera支持：window.getSelection()
                    // IE9以下支持：document.selection
                    window.getSelection ? window.getSelection().removeAllRanges() : document.selection.empty();
                    // 事件解绑

                }

            }
            document.onmouseup = function () {
                document.onmousemove = null;}

            }


    </script>
</head>
<body>
<div class="box">
    <div class="content">
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>
        孩儿励志出湘关,学不成名终不还.<br>
        埋骨何须桑梓地,人生无处不青山.<br>


    </div>
    <div class="scroll">
        <div class="bar"></div>
    </div>
</div>


</body>
</html>